{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/theek/Documents/DA%20Project/smart-parts/web/src/components/admin/RevenueChart.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport useSWR from \"swr\";\r\nimport { api } from \"@/lib/api\";\r\nimport {\r\n  ResponsiveContainer,\r\n  LineChart,\r\n  Line,\r\n  XAxis,\r\n  YAxis,\r\n  Tooltip,\r\n  CartesianGrid,\r\n} from \"recharts\";\r\nimport { useState } from \"react\";\r\n\r\ntype Point = { label: string; total: number };\r\n\r\nexport default function RevenueChart() {\r\n  const [granularity, setGranularity] = useState<\"day\" | \"month\">(\"month\");\r\n\r\n  const span = granularity === \"day\" ? 30 : 12;\r\n  const { data, isLoading, error, mutate } = useSWR<{ series: Point[]; granularity: \"day\" | \"month\" }>(\r\n    `/api/admin/revenue/series?granularity=${granularity}&span=${span}`,\r\n    api\r\n  );\r\n\r\n  const rows = data?.series ?? [];\r\n\r\n  return (\r\n    <div className=\"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm\">\r\n      <div className=\"flex items-center justify-between mb-3\">\r\n        <h2 className=\"text-lg font-semibold text-slate-800\">\r\n          Revenue ({granularity === \"day\" ? \"last 30 days\" : \"last 12 months\"})\r\n        </h2>\r\n\r\n        {/* Segmented control */}\r\n        <div className=\"inline-flex rounded-xl border border-slate-200 bg-white overflow-hidden\">\r\n          <button\r\n            onClick={() => setGranularity(\"day\")}\r\n            className={`px-3 py-1.5 text-sm ${granularity === \"day\" ? \"bg-slate-900 text-white\" : \"text-slate-700 hover:bg-slate-50\"}`}\r\n          >\r\n            Day\r\n          </button>\r\n          <button\r\n            onClick={() => setGranularity(\"month\")}\r\n            className={`px-3 py-1.5 text-sm ${granularity === \"month\" ? \"bg-slate-900 text-white\" : \"text-slate-700 hover:bg-slate-50\"}`}\r\n          >\r\n            Month\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {error && <div className=\"text-slate-500 text-sm\">Failed to load revenue.</div>}\r\n      {isLoading && <div className=\"text-slate-500 text-sm\">Loading revenue…</div>}\r\n\r\n      {!isLoading && rows.length === 0 && (\r\n        <div className=\"text-slate-500 text-sm\">No revenue data.</div>\r\n      )}\r\n\r\n      {rows.length > 0 && (\r\n        <ResponsiveContainer width=\"100%\" height={300}>\r\n          <LineChart data={rows}>\r\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e2e8f0\" />\r\n            <XAxis\r\n              dataKey=\"label\"\r\n              stroke=\"#64748b\"\r\n              tick={{ fontSize: 12 }}\r\n              // For days, show fewer ticks\r\n              interval={granularity === \"day\" ? Math.max(0, Math.floor(rows.length / 6)) : 0}\r\n            />\r\n            <YAxis stroke=\"#64748b\" tick={{ fontSize: 12 }} />\r\n            <Tooltip\r\n              labelFormatter={(label) =>\r\n                granularity === \"day\"\r\n                  ? new Date(label).toLocaleDateString()\r\n                  : label\r\n              }\r\n              formatter={(val: number) =>\r\n                new Intl.NumberFormat(undefined, { style: \"currency\", currency: \"USD\" }).format(val)\r\n              }\r\n              labelStyle={{ color: \"#0f172a\" }}\r\n            />\r\n            <Line\r\n              type=\"monotone\"\r\n              dataKey=\"total\"\r\n              stroke=\"#2563eb\"\r\n              strokeWidth={2}\r\n              dot={{ r: 2 }}\r\n              activeDot={{ r: 5 }}\r\n            />\r\n          </LineChart>\r\n        </ResponsiveContainer>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AAbA;;;;;;AAiBe,SAAS;IACtB,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAkB;IAEhE,MAAM,OAAO,gBAAgB,QAAQ,KAAK;IAC1C,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,IAAA,yKAAM,EAC/C,CAAC,sCAAsC,EAAE,YAAY,MAAM,EAAE,MAAM,EACnE,wHAAG;IAGL,MAAM,OAAO,MAAM,UAAU,EAAE;IAE/B,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;;4BAAuC;4BACzC,gBAAgB,QAAQ,iBAAiB;4BAAiB;;;;;;;kCAItE,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCACC,SAAS,IAAM,eAAe;gCAC9B,WAAW,CAAC,oBAAoB,EAAE,gBAAgB,QAAQ,4BAA4B,oCAAoC;0CAC3H;;;;;;0CAGD,8OAAC;gCACC,SAAS,IAAM,eAAe;gCAC9B,WAAW,CAAC,oBAAoB,EAAE,gBAAgB,UAAU,4BAA4B,oCAAoC;0CAC7H;;;;;;;;;;;;;;;;;;YAMJ,uBAAS,8OAAC;gBAAI,WAAU;0BAAyB;;;;;;YACjD,2BAAa,8OAAC;gBAAI,WAAU;0BAAyB;;;;;;YAErD,CAAC,aAAa,KAAK,MAAM,KAAK,mBAC7B,8OAAC;gBAAI,WAAU;0BAAyB;;;;;;YAGzC,KAAK,MAAM,GAAG,mBACb,8OAAC,0LAAmB;gBAAC,OAAM;gBAAO,QAAQ;0BACxC,cAAA,8OAAC,kKAAS;oBAAC,MAAM;;sCACf,8OAAC,8KAAa;4BAAC,iBAAgB;4BAAM,QAAO;;;;;;sCAC5C,8OAAC,8JAAK;4BACJ,SAAQ;4BACR,QAAO;4BACP,MAAM;gCAAE,UAAU;4BAAG;4BACrB,6BAA6B;4BAC7B,UAAU,gBAAgB,QAAQ,KAAK,GAAG,CAAC,GAAG,KAAK,KAAK,CAAC,KAAK,MAAM,GAAG,MAAM;;;;;;sCAE/E,8OAAC,8JAAK;4BAAC,QAAO;4BAAU,MAAM;gCAAE,UAAU;4BAAG;;;;;;sCAC7C,8OAAC,kKAAO;4BACN,gBAAgB,CAAC,QACf,gBAAgB,QACZ,IAAI,KAAK,OAAO,kBAAkB,KAClC;4BAEN,WAAW,CAAC,MACV,IAAI,KAAK,YAAY,CAAC,WAAW;oCAAE,OAAO;oCAAY,UAAU;gCAAM,GAAG,MAAM,CAAC;4BAElF,YAAY;gCAAE,OAAO;4BAAU;;;;;;sCAEjC,8OAAC,4JAAI;4BACH,MAAK;4BACL,SAAQ;4BACR,QAAO;4BACP,aAAa;4BACb,KAAK;gCAAE,GAAG;4BAAE;4BACZ,WAAW;gCAAE,GAAG;4BAAE;;;;;;;;;;;;;;;;;;;;;;;AAOhC","debugId":null}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/theek/Documents/DA%20Project/smart-parts/web/src/app/admin/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport useSWR from \"swr\";\r\nimport { api } from \"@/lib/api\";\r\nimport { TrendingUp, Users, Package, Receipt } from \"lucide-react\";\r\nimport RevenueChart from \"@/components/admin/RevenueChart\"; // ← imported\r\n\r\ntype Metrics = {\r\n  counts: { users: number; parts: number; orders: number; paidOrders: number };\r\n  revenue30d: { total: number };\r\n  ordersByStatus: Array<{ status: string; count: number }>;\r\n  recentOrders: Array<{ _id: string; status: string; grand?: number; createdAt?: string; userEmail?: string }>;\r\n  recentUsers: Array<{ _id: string; email: string; role: string; createdAt?: string }>;\r\n};\r\n\r\nexport default function AdminDashboard() {\r\n  const { data, error, isLoading, mutate } = useSWR<{ metrics: Metrics }>(\r\n    \"/api/admin/metrics\",\r\n    api\r\n  );\r\n\r\n  if (error) return <div className=\"p-6\">Failed to load metrics.</div>;\r\n\r\n  const m = data?.metrics;\r\n\r\n  const fmt = (v?: number) =>\r\n    typeof v === \"number\"\r\n      ? new Intl.NumberFormat(undefined, { style: \"currency\", currency: \"USD\" }).format(v)\r\n      : \"-\";\r\n\r\n  return (\r\n  <div className=\"space-y-4 bg-white text-slate-900\">\r\n  <div className=\"flex items-center justify-between\">\r\n    <h1 className=\"text-2xl md:text-3xl font-bold text-slate-900\">Dashboard</h1>\r\n    <button\r\n      onClick={() => mutate()}\r\n      className=\"inline-flex items-center gap-2 rounded-xl bg-blue-600 text-white px-4 py-2 hover:bg-blue-700 transition\"\r\n    >\r\n      Refresh\r\n    </button>\r\n  </div>\r\n\r\n      {/* Cards */}\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n    <Card icon={<Users className=\"w-5 h-5\" />} label=\"Users\" value={m?.counts.users} />\r\n    <Card icon={<Package className=\"w-5 h-5\" />} label=\"Parts\" value={m?.counts.parts} />\r\n    <Card icon={<Receipt className=\"w-5 h-5\" />} label=\"Orders\" value={m?.counts.orders} />\r\n    <Card icon={<TrendingUp className=\"w-5 h-5\" />} label=\"Revenue (30d)\" value={fmt(m?.revenue30d.total)} />\r\n      </div>\r\n\r\n      {/* Tables */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        {/* Recent Orders */}\r\n        <section className=\"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm\">\r\n          <div className=\"flex items-center justify-between mb-3\">\r\n            <h3 className=\"text-lg font-semibold\">Recent Orders</h3>\r\n            <a href=\"/admin/orders\" className=\"text-sm text-blue-600 dark:text-blue-400 hover:underline\">View all</a>\r\n          </div>\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"min-w-full text-sm\">\r\n              <thead>\r\n                <tr className=\"text-left text-slate-500 border-b border-slate-200 dark:border-slate-700\">\r\n                  <th className=\"py-2 pr-4\">Order</th>\r\n                  <th className=\"py-2 pr-4\">User</th>\r\n                  <th className=\"py-2 pr-4\">Total</th>\r\n                  <th className=\"py-2\">Status</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {(m?.recentOrders ?? []).map((o) => (\r\n                  <tr key={o._id} className=\"border-b border-slate-200/60 dark:border-slate-700/60\">\r\n                    <td className=\"py-2 pr-4\">#{o._id.slice(-6).toUpperCase()}</td>\r\n                    <td className=\"py-2 pr-4\">{o.userEmail ?? \"—\"}</td>\r\n                    <td className=\"py-2 pr-4\">{o.grand != null ? fmt(o.grand) : \"—\"}</td>\r\n                    <td className=\"py-2\">\r\n                      <span className={`px-2 py-1 rounded-lg text-xs ${o.status === \"paid\" ? \"bg-emerald-100 text-emerald-700\" : \"bg-slate-100 text-gray-700\"}`}>\r\n                        {o.status}\r\n                      </span>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n                {!isLoading && (m?.recentOrders?.length ?? 0) === 0 && (\r\n                  <tr><td className=\"py-4 text-slate-500\" colSpan={4}>No orders.</td></tr>\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </section>\r\n\r\n        {/* Recent Users */}\r\n        <section className=\"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm\">\r\n          <div className=\"flex items-center justify-between mb-3\">\r\n            <h3 className=\"text-lg font-semibold\">Recent Users</h3>\r\n            <a href=\"/admin/users\" className=\"text-sm text-blue-600 dark:text-blue-400 hover:underline\">View all</a>\r\n          </div>\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"min-w-full text-sm\">\r\n              <thead>\r\n                <tr className=\"text-left text-slate-500 border-b border-slate-200 dark:border-slate-700\">\r\n                  <th className=\"py-2 pr-4\">Email</th>\r\n                  <th className=\"py-2 pr-4\">Role</th>\r\n                  <th className=\"py-2\">Joined</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {(m?.recentUsers ?? []).map((u) => (\r\n                  <tr key={u._id} className=\"border-b border-slate-200/60 dark:border-slate-700/60\">\r\n                    <td className=\"py-2 pr-4\">{u.email}</td>\r\n                    <td className=\"py-2 pr-4\">{u.role}</td>\r\n                    <td className=\"py-2\">{u.createdAt ? new Date(u.createdAt).toLocaleDateString() : \"—\"}</td>\r\n                  </tr>\r\n                ))}\r\n                {!isLoading && (m?.recentUsers?.length ?? 0) === 0 && (\r\n                  <tr><td className=\"py-4 text-slate-500\" colSpan={3}>No users.</td></tr>\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </section>\r\n                 {/* Revenue Chart */}\r\n      <RevenueChart />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction Card({ icon, label, value }: { icon: React.ReactNode; label: string; value?: number | string }) {\r\n  return (\r\n    <div className=\"rounded-2xl border border-slate-200 bg-white p-5 flex items-center gap-4 shadow-sm\">\r\n      <div className=\"w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 text-white flex items-center justify-center\">\r\n        {icon}\r\n      </div>\r\n      <div>\r\n        <div className=\"text-sm text-slate-500\">{label}</div>\r\n        <div className=\"text-xl font-semibold text-slate-900\">{value ?? \"—\"}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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","debugId":null}}]
}