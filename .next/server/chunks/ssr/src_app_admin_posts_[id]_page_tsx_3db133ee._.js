module.exports=[28440,a=>{"use strict";var b=a.i(87924),c=a.i(72596),d=a.i(19032),e=a.i(50944),f=a.i(72131);function g(){let{id:a}=(0,e.useParams)(),g=(0,e.useRouter)(),{data:h,mutate:i}=(0,c.default)(`/api/admin/posts/${a}`,d.api),[j,k]=(0,f.useState)(""),[l,m]=(0,f.useState)(""),[n,o]=(0,f.useState)(!0),[p,q]=(0,f.useState)(""),[r,s]=(0,f.useState)(""),[t,u]=(0,f.useState)(""),[v,w]=(0,f.useState)(""),[x,y]=(0,f.useState)(""),[z,A]=(0,f.useState)(null);async function B(b){b.preventDefault();let c={title:j,body:l,published:n,vehicleTags:{make:p||void 0,model:r||void 0,yearFrom:t?Number(t):void 0,yearTo:v?Number(v):void 0},partTags:x.split(",").map(a=>a.trim()).filter(Boolean)};await (0,d.api)(`/api/admin/posts/${a}`,{method:"PATCH",body:JSON.stringify(c)}),i(),g.push("/admin/posts")}return((0,f.useEffect)(()=>{let a=h?.post;a&&(k(a.title||""),m(a.body||""),o(!!a.published),q(a.vehicleTags?.make||""),s(a.vehicleTags?.model||""),u(a.vehicleTags?.yearFrom??""),w(a.vehicleTags?.yearTo??""),y(Array.isArray(a.partTags)?a.partTags.join(", "):""))},[h]),h)?(0,b.jsxs)("div",{className:"max-w-3xl",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold mb-4 text-slate-900",children:"Edit Post"}),(0,b.jsxs)("form",{onSubmit:B,className:"space-y-4 bg-white border border-slate-200 rounded-2xl p-6",children:[(0,b.jsx)("input",{className:"w-full border rounded-xl px-3 py-2",value:j,onChange:a=>k(a.target.value)}),(0,b.jsx)("textarea",{className:"w-full border rounded-xl px-3 py-2 min-h-[120px]",value:l,onChange:a=>m(a.target.value)}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{id:"pub",type:"checkbox",checked:n,onChange:a=>o(a.target.checked)}),(0,b.jsx)("label",{htmlFor:"pub",className:"text-sm",children:"Published (visible to users)"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsx)("input",{className:"border rounded-xl px-3 py-2",placeholder:"Make",value:p,onChange:a=>q(a.target.value)}),(0,b.jsx)("input",{className:"border rounded-xl px-3 py-2",placeholder:"Model",value:r,onChange:a=>s(a.target.value)}),(0,b.jsx)("input",{className:"border rounded-xl px-3 py-2",placeholder:"Year From",type:"number",value:t,onChange:a=>u(a.target.value)}),(0,b.jsx)("input",{className:"border rounded-xl px-3 py-2",placeholder:"Year To",type:"number",value:v,onChange:a=>w(a.target.value)})]}),(0,b.jsx)("input",{className:"w-full border rounded-xl px-3 py-2",placeholder:"Part tags (comma separated)",value:x,onChange:a=>y(a.target.value)}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700",children:"Image"}),h?.post?.imageUrl?(0,b.jsxs)("div",{className:"rounded-xl border p-3",children:[(0,b.jsx)("img",{src:`${d.API}${h.post.imageUrl}`,alt:"",className:"max-h-64 rounded-lg border"}),(0,b.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,b.jsx)("input",{type:"file",accept:"image/png,image/jpeg,image/jpg,image/webp",onChange:a=>A(a.target.files?.[0]??null),className:"text-sm"}),(0,b.jsx)("button",{type:"button",onClick:async()=>{if(!z)return alert("Choose a file first");let b=new FormData;b.append("image",z),await fetch(`http://localhost:3000/api/admin/posts/${a}/image`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:b}),A(null),await i()},className:"border rounded-xl px-3 py-2 text-sm hover:bg-slate-50",children:"Replace"}),(0,b.jsx)("button",{type:"button",onClick:async()=>{confirm("Remove image?")&&(await fetch(`http://localhost:3000/api/admin/posts/${a}/image`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}}),await i())},className:"text-red-600 hover:text-red-800 text-sm",children:"Remove"})]})]}):(0,b.jsxs)("div",{className:"rounded-xl border p-3",children:[(0,b.jsx)("div",{className:"text-sm text-slate-600 mb-2",children:"No image attached."}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"file",accept:"image/png,image/jpeg,image/jpg,image/webp",onChange:a=>A(a.target.files?.[0]??null),className:"text-sm"}),(0,b.jsx)("button",{type:"button",onClick:async()=>{if(!z)return alert("Choose a file first");let b=new FormData;b.append("image",z),await fetch(`http://localhost:3000/api/admin/posts/${a}/image`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:b}),A(null),await i()},className:"border rounded-xl px-3 py-2 text-sm hover:bg-slate-50",children:"Upload"})]})]})]}),(0,b.jsx)("button",{className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-xl",children:"Save"})]})]}):(0,b.jsx)("div",{children:"Loadingâ€¦"})}a.s(["default",()=>g])}];

//# sourceMappingURL=src_app_admin_posts_%5Bid%5D_page_tsx_3db133ee._.js.map