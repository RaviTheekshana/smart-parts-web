{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/theek/Documents/DA%20Project/smart-parts/web/src/app/admin/products/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport useSWR from \"swr\";\r\nimport { api } from \"@/lib/api\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useState } from \"react\";\r\nimport { Plus, Edit, Trash2, RefreshCcw, Upload } from \"lucide-react\";\r\n\r\ntype Part = {\r\n  _id: string;\r\n  sku: string;\r\n  name: string;\r\n  brand?: string;\r\n  price?: number;\r\n  createdAt?: string;\r\n};\r\n\r\nexport default function ProductsPage() {\r\n  const router = useRouter();\r\n  const [query, setQuery] = useState(\"\");\r\n  const [page, setPage] = useState(1);\r\n  const [limit, setLimit] = useState(20);\r\n  const { data, mutate, isLoading } = useSWR<{\r\n  parts: Part[]; total: number; page: number; pageSize: number; totalPages: number;\r\n    }>(`/api/admin/parts?query=${encodeURIComponent(query)}&page=${page}&limit=${limit}`, api);\r\n\r\n    const totalPages = data?.totalPages ?? 1;\r\n\r\n  const parts = data?.parts || [];\r\n  const fmt = (v?: number) =>\r\n    typeof v === \"number\"\r\n      ? new Intl.NumberFormat(undefined, { style: \"currency\", currency: \"LKR\" }).format(v)\r\n      : \"-\";\r\n\r\n  async function handleDelete(id: string) {\r\n    if (!confirm(\"Delete this part?\")) return;\r\n    await api(`/api/admin/parts/${id}`, { method: \"DELETE\" });\r\n    mutate();\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <h1 className=\"text-2xl font-bold text-slate-900\">Products</h1>\r\n        <div className=\"flex gap-2\">\r\n          <input\r\n            value={query}\r\n            onChange={(e) => setQuery(e.target.value)}\r\n            placeholder=\"Search sku, name, brand...\"\r\n            className=\"border rounded-xl px-3 py-2 text-sm\"\r\n          />\r\n          <button\r\n            onClick={() => router.push(\"/admin/products/import\")}\r\n            className=\"inline-flex items-center gap-2 border px-3 py-2 rounded-xl text-sm\"\r\n          >\r\n            <Upload className=\"w-4 h-4\" /> Import CSV\r\n          </button>\r\n          <button\r\n            onClick={() => router.push(\"/admin/products/new\")}\r\n            className=\"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-xl text-sm\"\r\n          >\r\n            <Plus className=\"w-4 h-4\" /> New\r\n          </button>\r\n          <button\r\n            onClick={() => mutate()}\r\n            className=\"inline-flex items-center gap-2 border px-3 py-2 rounded-xl text-sm\"\r\n          >\r\n            <RefreshCcw className=\"w-4 h-4\" /> Refresh\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"overflow-x-auto rounded-xl border border-slate-200 bg-white\">\r\n        <table className=\"min-w-full text-sm\">\r\n          <thead>\r\n            <tr className=\"border-b border-slate-200 text-left text-slate-600\">\r\n              <th className=\"py-2 px-4\">SKU</th>\r\n              <th className=\"py-2 px-4\">Name</th>\r\n              <th className=\"py-2 px-4\">Brand</th>\r\n              <th className=\"py-2 px-4\">Price</th>\r\n              <th className=\"py-2 px-4\">Created</th>\r\n              <th className=\"py-2 px-4 text-right\">Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {parts.map((p) => (\r\n              <tr key={p._id} className=\"border-b border-slate-200 hover:bg-gray-100\">\r\n                <td className=\"py-2 px-4 font-mono\">{p.sku}</td>\r\n                <td className=\"py-2 px-4\">{p.name}</td>\r\n                <td className=\"py-2 px-4\">{p.brand ?? \"—\"}</td>\r\n                <td className=\"py-2 px-4\">{fmt(p.price)}</td>\r\n                <td className=\"py-2 px-4\">{p.createdAt ? new Date(p.createdAt).toLocaleDateString() : \"—\"}</td>\r\n                <td className=\"py-2 px-4 text-right space-x-2\">\r\n                  <button\r\n                    onClick={() => router.push(`/admin/products/${p._id}`)}\r\n                    className=\"inline-flex items-center text-blue-600 hover:text-blue-800\"\r\n                  >\r\n                    <Edit className=\"w-4 h-4\" />\r\n                  </button>\r\n                  <button\r\n                    onClick={() => handleDelete(p._id)}\r\n                    className=\"inline-flex items-center text-red-600 hover:text-red-800\"\r\n                  >\r\n                    <Trash2 className=\"w-4 h-4\" />\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n            {!isLoading && parts.length === 0 && (\r\n              <tr><td className=\"py-4 px-4 text-center text-slate-500\" colSpan={6}>No products found</td></tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n        {/* Footer controls */}\r\n    <div className=\"mt-4 flex items-center justify-between\">\r\n    <div className=\"text-sm text-slate-600\">\r\n        Page {data?.page ?? 1} / {totalPages}, {data?.total ?? 0} results\r\n    </div>\r\n    <div className=\"flex items-center gap-2\">\r\n        <select\r\n        value={limit}\r\n        onChange={(e) => { setLimit(Number(e.target.value)); setPage(1); }}\r\n        className=\"border rounded-xl px-2 py-1 text-sm\"\r\n        >\r\n        {[10,20,50,100].map(n => <option key={n} value={n}>{n} / page</option>)}\r\n        </select>\r\n        <button\r\n        className=\"border rounded-xl px-3 py-1 disabled:opacity-50\"\r\n        disabled={page <= 1}\r\n        onClick={() => setPage(p => Math.max(1, p - 1))}\r\n        >\r\n        Prev\r\n        </button>\r\n        <button\r\n        className=\"border rounded-xl px-3 py-1 disabled:opacity-50\"\r\n        disabled={page >= totalPages}\r\n        onClick={() => setPage(p => Math.min(totalPages, p + 1))}\r\n        >\r\n        Next\r\n        </button>\r\n    </div>\r\n    </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}