{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/theek/Documents/DA%20Project/smart-parts/web/src/app/orders/page.tsx"],"sourcesContent":["\"use client\";\n\nimport useSWR from \"swr\";\nimport { api } from \"@/lib/api\";\nimport { useAuth } from \"@/context/AuthContext\";\nimport { useMemo, useState } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport { CheckCircle2, AlertCircle, RefreshCw, ShoppingBag, ReceiptText } from \"lucide-react\";\n\ntype Order = {\n  _id: string;\n  status: string;\n  totals: { grand: number };\n  // add: createdAt, number, etc. when available\n};\ntype OrdersResponse = { orders: Order[] };\n\nexport default function OrdersPage() {\n  const { token } = useAuth();\n  const router = useRouter();\n  const search = useSearchParams();\n  const showSuccessInit = search?.get(\"success\") === \"1\";\n  const [showSuccess, setShowSuccess] = useState(showSuccessInit);\n\n  const { data, error, isLoading, mutate } = useSWR<OrdersResponse>(\n    token ? \"/api/orders/my\" : null,\n    api\n  );\n\n  const orders = data?.orders ?? [];\n\n  function fmtMoney(v?: number) {\n    if (typeof v !== \"number\") return \"-\";\n    try {\n      return new Intl.NumberFormat(undefined, {\n        style: \"currency\",\n        currency: \"LKR\",\n        maximumFractionDigits: 2,\n      }).format(v);\n    } catch {\n      return `$${v.toFixed(2)}`;\n    }\n  }\n\n  function pill(status: string) {\n    const s = status.toLowerCase();\n    if (s.includes(\"paid\") || s.includes(\"complete\"))\n      return \"bg-emerald-50 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300 border-emerald-200/60 dark:border-emerald-700/60\";\n    if (s.includes(\"pending\") || s.includes(\"processing\"))\n      return \"bg-amber-50 text-amber-700 dark:bg-amber-900/30 dark:text-amber-300 border-amber-200/60 dark:border-amber-700/60\";\n    if (s.includes(\"failed\") || s.includes(\"cancel\"))\n      return \"bg-rose-50 text-rose-700 dark:bg-rose-900/30 dark:text-rose-300 border-rose-200/60 dark:border-rose-700/60\";\n    return \"bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-300 border-slate-200 dark:border-slate-700\";\n  }\n\n  if (!token) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-6\">\n        <p className=\"text-slate-700 dark:text-slate-300\">\n          Please{\" \"}\n          <a className=\"text-blue-600 dark:text-blue-400 underline\" href=\"/login\">\n            login\n          </a>{\" \"}\n          to view your orders.\n        </p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-6\">\n        <div className=\"max-w-md w-full rounded-2xl border border-slate-200 dark:border-slate-700 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl p-6\">\n          <div className=\"flex items-start gap-3\">\n            <AlertCircle className=\"w-6 h-6 text-rose-600\" />\n            <div>\n              <h2 className=\"text-lg font-semibold text-slate-900 dark:text-white\">Error loading orders</h2>\n              <p className=\"text-sm text-slate-600 dark:text-slate-400 mt-1\">\n                Please try again in a moment.\n              </p>\n            </div>\n          </div>\n          <button\n            onClick={() => location.reload()}\n            className=\"mt-4 inline-flex items-center gap-2 rounded-xl bg-slate-900 text-white dark:bg-white dark:text-slate-900 px-4 py-2 hover:opacity-90 transition\"\n          >\n            <RefreshCw className=\"w-4 h-4\" />\n            Reload\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-100 dark:from-slate-950 dark:via-slate-900 dark:to-slate-800 p-4 md:p-8\">\n      <div className=\"pointer-events-none fixed inset-0 bg-[radial-gradient(circle_at_50%_20%,rgba(120,119,198,0.10),transparent_50%)] dark:bg-[radial-gradient(circle_at_50%_20%,rgba(120,119,198,0.05),transparent_50%)]\" />\n      <div className=\"pointer-events-none fixed inset-0 bg-[radial-gradient(circle_at_50%_20%,rgba(120,119,198,0.10),transparent_50%)] dark:bg-[radial-gradient(circle_at_50%_20%,rgba(120,119,198,0.05),transparent_50%)]\" />\n      <div className=\"relative mx-auto max-w-6xl pt-24\">\n        <div className=\"bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl border border-slate-200/50 dark:border-slate-700/50 rounded-2xl shadow-2xl p-6 md:p-10\">\n          {/* Header */}\n          <div className=\"flex items-center justify-between gap-3\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow\">\n                <ReceiptText className=\"w-6 h-6 text-white\" />\n              </div>\n              <h1 className=\"text-2xl md:text-3xl font-bold text-slate-900 dark:text-white\">My Orders</h1>\n            </div>\n            <button\n              onClick={() => mutate()}\n              className=\"inline-flex items-center gap-2 rounded-xl border-0 bg-purple-600 text-white px-4 py-2 hover:opacity-80 transition\"\n            >\n              <RefreshCw className=\"w-4 h-4\" />\n              Refresh\n            </button>\n          </div>\n\n          {/* Success banner after redirect */}\n          {showSuccess && (\n            <div className=\"mt-6 rounded-2xl border border-emerald-200/60 dark:border-emerald-700/60 bg-emerald-50 dark:bg-emerald-900/20 p-4 flex items-start gap-3\">\n              <CheckCircle2 className=\"w-5 h-5 text-emerald-600 dark:text-emerald-400 mt-0.5\" />\n              <div className=\"flex-1 text-sm text-emerald-800 dark:text-emerald-200\">\n                Payment successful. Your order has been placed.\n              </div>\n              <button\n                onClick={() => setShowSuccess(false)}\n                className=\"text-emerald-700/70 dark:text-emerald-300/70 hover:opacity-80\"\n                aria-label=\"Dismiss\"\n              >\n                ×\n              </button>\n            </div>\n          )}\n\n          {/* List / skeleton / empty */}\n          <div className=\"mt-6\">\n            {isLoading ? (\n              <ul className=\"space-y-4\">\n                {Array.from({ length: 3 }).map((_, i) => (\n                  <li\n                    key={i}\n                    className=\"h-24 rounded-2xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/70 animate-pulse\"\n                  />\n                ))}\n              </ul>\n            ) : orders.length === 0 ? (\n              <div className=\"rounded-2xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/70 p-8 text-center\">\n                <p className=\"text-slate-700 dark:text-slate-300\">You don’t have any orders yet.</p>\n                <button\n                  onClick={() => router.push(\"/catalog\")}\n                  className=\"mt-4 inline-flex items-center gap-2 rounded-xl bg-slate-900 text-white dark:bg-white dark:text-slate-900 px-4 py-2 hover:opacity-90 transition\"\n                >\n                  <ShoppingBag className=\"w-4 h-4\" />\n                  Continue shopping\n                </button>\n              </div>\n            ) : (\n              <ul className=\"space-y-4\">\n                {orders.map((o) => (\n                  <li\n                    key={o._id}\n                    className=\"rounded-2xl border border-slate-200 dark:border-slate-700 bg-white/70 dark:bg-slate-900/70 p-5 flex items-center justify-between gap-4\"\n                  >\n                    <div className=\"min-w-0\">\n                      <div className=\"text-sm text-slate-500 dark:text-slate-400\">Order</div>\n                      <div className=\"text-base md:text-lg font-semibold text-slate-900 dark:text-white truncate\">\n                        {o._id}\n                      </div>\n                      <div className=\"mt-2 inline-flex items-center gap-2\">\n                        <span\n                          className={`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold border ${pill(\n                            o.status\n                          )}`}\n                        >\n                          {o.status}\n                        </span>\n                      </div>\n                    </div>\n\n                    <div className=\"text-right\">\n                      <div className=\"text-sm text-slate-500 dark:text-slate-400\">Total</div>\n                      <div className=\"text-lg font-bold text-slate-900 dark:text-white\">\n                        {fmtMoney(o.totals?.grand)}\n                      </div>\n                      <div className=\"mt-3\">\n                        <a\n                          href={`/orders/${o._id}`}\n                          className=\"inline-flex items-center justify-center rounded-xl border bg-blue-600 dark:border-slate-700 px-3 py-2 text-sm text-white font-medium hover:bg-blue-700 transition\"\n                        >\n                          View details\n                        </a>\n                      </div>\n                    </div>\n                  </li>\n                ))}\n              </ul>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;;;AAPA;;;;;;;AAiBe,SAAS;;IACtB,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,4IAAO;IACzB,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,SAAS,IAAA,wJAAe;IAC9B,MAAM,kBAAkB,CAAA,mBAAA,6BAAA,OAAQ,GAAG,CAAC,gBAAe;IACnD,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAE/C,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,SAAS,EAAE,MAAM,EAAE,GAAG,IAAA,4KAAM,EAC/C,QAAQ,mBAAmB,MAC3B,2HAAG;QAGU;IAAf,MAAM,SAAS,CAAA,eAAA,iBAAA,2BAAA,KAAM,MAAM,cAAZ,0BAAA,eAAgB,EAAE;IAEjC,SAAS,SAAS,CAAU;QAC1B,IAAI,OAAO,MAAM,UAAU,OAAO;QAClC,IAAI;YACF,OAAO,IAAI,KAAK,YAAY,CAAC,WAAW;gBACtC,OAAO;gBACP,UAAU;gBACV,uBAAuB;YACzB,GAAG,MAAM,CAAC;QACZ,EAAE,UAAM;YACN,OAAO,AAAC,IAAgB,OAAb,EAAE,OAAO,CAAC;QACvB;IACF;IAEA,SAAS,KAAK,MAAc;QAC1B,MAAM,IAAI,OAAO,WAAW;QAC5B,IAAI,EAAE,QAAQ,CAAC,WAAW,EAAE,QAAQ,CAAC,aACnC,OAAO;QACT,IAAI,EAAE,QAAQ,CAAC,cAAc,EAAE,QAAQ,CAAC,eACtC,OAAO;QACT,IAAI,EAAE,QAAQ,CAAC,aAAa,EAAE,QAAQ,CAAC,WACrC,OAAO;QACT,OAAO;IACT;IAEA,IAAI,CAAC,OAAO;QACV,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAE,WAAU;;oBAAqC;oBACzC;kCACP,6LAAC;wBAAE,WAAU;wBAA6C,MAAK;kCAAS;;;;;;oBAEnE;oBAAI;;;;;;;;;;;;IAKjB;IAEA,IAAI,OAAO;QACT,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,sOAAW;gCAAC,WAAU;;;;;;0CACvB,6LAAC;;kDACC,6LAAC;wCAAG,WAAU;kDAAuD;;;;;;kDACrE,6LAAC;wCAAE,WAAU;kDAAkD;;;;;;;;;;;;;;;;;;kCAKnE,6LAAC;wBACC,SAAS,IAAM,SAAS,MAAM;wBAC9B,WAAU;;0CAEV,6LAAC,gOAAS;gCAAC,WAAU;;;;;;4BAAY;;;;;;;;;;;;;;;;;;IAM3C;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;;;;;0BACf,6LAAC;gBAAI,WAAU;;;;;;0BACf,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCAEb,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC,sOAAW;gDAAC,WAAU;;;;;;;;;;;sDAEzB,6LAAC;4CAAG,WAAU;sDAAgE;;;;;;;;;;;;8CAEhF,6LAAC;oCACC,SAAS,IAAM;oCACf,WAAU;;sDAEV,6LAAC,gOAAS;4CAAC,WAAU;;;;;;wCAAY;;;;;;;;;;;;;wBAMpC,6BACC,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,wOAAY;oCAAC,WAAU;;;;;;8CACxB,6LAAC;oCAAI,WAAU;8CAAwD;;;;;;8CAGvE,6LAAC;oCACC,SAAS,IAAM,eAAe;oCAC9B,WAAU;oCACV,cAAW;8CACZ;;;;;;;;;;;;sCAOL,6LAAC;4BAAI,WAAU;sCACZ,0BACC,6LAAC;gCAAG,WAAU;0CACX,MAAM,IAAI,CAAC;oCAAE,QAAQ;gCAAE,GAAG,GAAG,CAAC,CAAC,GAAG,kBACjC,6LAAC;wCAEC,WAAU;uCADL;;;;;;;;;uCAKT,OAAO,MAAM,KAAK,kBACpB,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAE,WAAU;kDAAqC;;;;;;kDAClD,6LAAC;wCACC,SAAS,IAAM,OAAO,IAAI,CAAC;wCAC3B,WAAU;;0DAEV,6LAAC,sOAAW;gDAAC,WAAU;;;;;;4CAAY;;;;;;;;;;;;qDAKvC,6LAAC;gCAAG,WAAU;0CACX,OAAO,GAAG,CAAC,CAAC;wCAwBK;yDAvBhB,6LAAC;wCAEC,WAAU;;0DAEV,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;kEAA6C;;;;;;kEAC5D,6LAAC;wDAAI,WAAU;kEACZ,EAAE,GAAG;;;;;;kEAER,6LAAC;wDAAI,WAAU;kEACb,cAAA,6LAAC;4DACC,WAAW,AAAC,kFAEV,OAF2F,KAC3F,EAAE,MAAM;sEAGT,EAAE,MAAM;;;;;;;;;;;;;;;;;0DAKf,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;kEAA6C;;;;;;kEAC5D,6LAAC;wDAAI,WAAU;kEACZ,UAAS,YAAA,EAAE,MAAM,cAAR,gCAAA,UAAU,KAAK;;;;;;kEAE3B,6LAAC;wDAAI,WAAU;kEACb,cAAA,6LAAC;4DACC,MAAM,AAAC,WAAgB,OAAN,EAAE,GAAG;4DACtB,WAAU;sEACX;;;;;;;;;;;;;;;;;;uCA5BA,EAAE,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0C9B;GAzLwB;;QACJ,4IAAO;QACV,kJAAS;QACT,wJAAe;QAIa,4KAAM;;;KAP3B","debugId":null}}]
}