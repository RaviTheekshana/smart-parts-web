(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,75254,e=>{"use strict";var t=e.i(71645);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},a=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:l="",children:o,iconNode:c,...d},u)=>(0,t.createElement)("svg",{ref:u,...n,width:r,height:r,stroke:e,strokeWidth:i?24*Number(s)/Number(r):s,className:a("lucide",l),...!o&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(d)&&{"aria-hidden":"true"},...d},[...c.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(o)?o:[o]])),i=(e,n)=>{let i=(0,t.forwardRef)(({className:i,...l},o)=>(0,t.createElement)(s,{ref:o,iconNode:n,className:a(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,i),...l}));return i.displayName=r(e),i};e.s(["default",()=>i],75254)},55838,(e,t,r)=>{"use strict";var a=e.r(71645),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=a.useState,i=a.useEffect,l=a.useLayoutEffect,o=a.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!n(e,r)}catch(e){return!0}}var d="u"<typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),a=s({inst:{value:r,getSnapshot:t}}),n=a[0].inst,d=a[1];return l(function(){n.value=r,n.getSnapshot=t,c(n)&&d({inst:n})},[e,r,t]),i(function(){return c(n)&&d({inst:n}),e(function(){c(n)&&d({inst:n})})},[e]),o(r),r};r.useSyncExternalStore=void 0!==a.useSyncExternalStore?a.useSyncExternalStore:d},2239,(e,t,r)=>{"use strict";t.exports=e.r(55838)},83599,17805,e=>{"use strict";let t;var r=e.i(71645),a=e.i(2239);e.s(["ERROR_REVALIDATE_EVENT",()=>3,"FOCUS_EVENT",()=>0,"MUTATE_EVENT",()=>2,"RECONNECT_EVENT",()=>1],11671);var n=Object.prototype.hasOwnProperty;let s=new WeakMap,i=()=>{},l=i(),o=Object,c=e=>e===l,d=e=>"function"==typeof e,u=(e,t)=>({...e,...t}),m=e=>d(e.then),f={},h={},x="undefined",p=typeof window!=x,g=typeof document!=x,b=p&&"Deno"in window,v=(e,t)=>{let r=s.get(e);return[()=>!c(t)&&e.get(t)||f,a=>{if(!c(t)){let n=e.get(t);t in h||(h[t]=n),r[5](t,u(n,a),n||f)}},r[6],()=>!c(t)&&t in h?h[t]:!c(t)&&e.get(t)||f]},w=!0,[y,N]=p&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[i,i],j={initFocus:e=>(g&&document.addEventListener("visibilitychange",e),y("focus",e),()=>{g&&document.removeEventListener("visibilitychange",e),N("focus",e)}),initReconnect:e=>{let t=()=>{w=!0,e()},r=()=>{w=!1};return y("online",t),y("offline",r),()=>{N("online",t),N("offline",r)}}},E=!r.default.useId,S=!p||b,O=e=>p&&typeof window.requestAnimationFrame!=x?window.requestAnimationFrame(e):setTimeout(e,1),k=S?r.useEffect:r.useLayoutEffect,T="u">typeof navigator&&navigator.connection,R=!S&&T&&(["slow-2g","2g"].includes(T.effectiveType)||T.saveData),_=new WeakMap,A=(e,t)=>e===`[object ${t}]`,C=0,V=e=>{let t,r,a=typeof e,n=o.prototype.toString.call(e),s=A(n,"Date"),i=A(n,"RegExp"),l=A(n,"Object");if(o(e)!==e||s||i)t=s?e.toJSON():"symbol"==a?e.toString():"string"==a?JSON.stringify(e):""+e;else{if(t=_.get(e))return t;if(t=++C+"~",_.set(e,t),Array.isArray(e)){for(r=0,t="@";r<e.length;r++)t+=V(e[r])+",";_.set(e,t)}if(l){t="#";let a=o.keys(e).sort();for(;!c(r=a.pop());)c(e[r])||(t+=r+":"+V(e[r])+",");_.set(e,t)}}return t},L=e=>{if(d(e))try{e=e()}catch(t){e=""}let t=e;return[e="string"==typeof e?e:(Array.isArray(e)?e.length:e)?V(e):"",t]},D=0,M=()=>++D;async function P(...e){let[t,r,a,n]=e,i=u({populateCache:!0,throwOnError:!0},"boolean"==typeof n?{revalidate:n}:n||{}),o=i.populateCache,f=i.rollbackOnError,h=i.optimisticData,x=i.throwOnError;if(d(r)){let e=[];for(let a of t.keys())!/^\$(inf|sub)\$/.test(a)&&r(t.get(a)._k)&&e.push(a);return Promise.all(e.map(p))}return p(r);async function p(r){let n,[u]=L(r);if(!u)return;let[p,g]=v(t,u),[b,w,y,N]=s.get(t),j=()=>{let e=b[u];return(d(i.revalidate)?i.revalidate(p().data,r):!1!==i.revalidate)&&(delete y[u],delete N[u],e&&e[0])?e[0](2).then(()=>p().data):p().data};if(e.length<3)return j();let E=a,S=!1,O=M();w[u]=[O,0];let k=!c(h),T=p(),R=T.data,_=T._c,A=c(_)?R:_;if(k&&g({data:h=d(h)?h(A,R):h,_c:A}),d(E))try{E=E(A)}catch(e){n=e,S=!0}if(E&&m(E)){let e;if(E=await E.catch(e=>{n=e,S=!0}),O!==w[u][0]){if(S)throw n;return E}S&&k&&(e=n,"function"==typeof f?f(e):!1!==f)&&(o=!0,g({data:A,_c:l}))}if(o&&!S&&(d(o)?g({data:o(E,A),error:l,_c:l}):g({data:E,error:l,_c:l})),w[u][1]=M(),Promise.resolve(j()).then(()=>{g({_c:l})}),S){if(x)throw n;return}return E}}let $=(e,t)=>{for(let r in e)e[r][0]&&e[r][0](t)},I=(e,t)=>{if(!s.has(e)){let r=u(j,t),a=Object.create(null),n=P.bind(l,e),o=i,c=Object.create(null),d=(e,t)=>{let r=c[e]||[];return c[e]=r,r.push(t),()=>r.splice(r.indexOf(t),1)},m=(t,r,a)=>{e.set(t,r);let n=c[t];if(n)for(let e of n)e(r,a)},f=()=>{if(!s.has(e)&&(s.set(e,[a,Object.create(null),Object.create(null),Object.create(null),n,m,d]),!S)){let t=r.initFocus(setTimeout.bind(l,$.bind(l,a,0))),n=r.initReconnect(setTimeout.bind(l,$.bind(l,a,1)));o=()=>{t&&t(),n&&n(),s.delete(e)}}};return f(),[e,n,f,o]}return[e,s.get(e)[4]]},[U,W]=I(new Map),F=u({onLoadingSlow:i,onSuccess:i,onError:i,onErrorRetry:(e,t,r,a,n)=>{let s=r.errorRetryCount,i=n.retryCount,l=~~((Math.random()+.5)*(1<<(i<8?i:8)))*r.errorRetryInterval;(c(s)||!(i>s))&&setTimeout(a,l,n)},onDiscarded:i,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:R?1e4:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:R?5e3:3e3,compare:function e(t,r){var a,s;if(t===r)return!0;if(t&&r&&(a=t.constructor)===r.constructor){if(a===Date)return t.getTime()===r.getTime();if(a===RegExp)return t.toString()===r.toString();if(a===Array){if((s=t.length)===r.length)for(;s--&&e(t[s],r[s]););return -1===s}if(!a||"object"==typeof t){for(a in s=0,t)if(n.call(t,a)&&++s&&!n.call(r,a)||!(a in r)||!e(t[a],r[a]))return!1;return Object.keys(r).length===s}}return t!=t&&r!=r},isPaused:()=>!1,cache:U,mutate:W,fallback:{}},{isOnline:()=>w,isVisible:()=>{let e=g&&document.visibilityState;return c(e)||"hidden"!==e}}),q=(e,t)=>{let r=u(e,t);if(t){let{use:a,fallback:n}=e,{use:s,fallback:i}=t;a&&s&&(r.use=a.concat(s)),n&&i&&(r.fallback=u(n,i))}return r},B=(0,r.createContext)({}),z=e=>{let{value:t}=e,a=(0,r.useContext)(B),n=d(t),s=(0,r.useMemo)(()=>n?t(a):t,[n,a,t]),i=(0,r.useMemo)(()=>n?s:q(a,s),[n,a,s]),o=s&&s.provider,c=(0,r.useRef)(l);o&&!c.current&&(c.current=I(o(i.cache||U),s));let m=c.current;return m&&(i.cache=m[0],i.mutate=m[1]),k(()=>{if(m)return m[2]&&m[2](),m[3]},[]),(0,r.createElement)(B.Provider,u(e,{value:i}))};e.s(["A",()=>i,"B",()=>m,"I",()=>S,"O",()=>o,"S",()=>B,"U",()=>l,"a",()=>d,"b",()=>s,"c",()=>U,"d",()=>F,"e",()=>c,"f",()=>q,"g",()=>z,"i",()=>p,"j",()=>W,"m",()=>u,"n",()=>P,"o",()=>M,"r",()=>E,"s",()=>L,"t",()=>O,"u",()=>k,"z",()=>v],17805);var J=e.i(11671);let H=p&&window.__SWR_DEVTOOLS_USE__,Y=(H?window.__SWR_DEVTOOLS_USE__:[]).concat(e=>(t,r,a)=>{let n=r&&((...e)=>{let[a]=L(t),[,,,n]=s.get(U);if(a.startsWith("$inf$"))return r(...e);let i=n[a];return c(i)?r(...e):(delete n[a],i)});return e(t,n,a)});H&&(window.__SWR_DEVTOOLS_REACT__=r.default);let K=()=>{},Z=K(),G=(new WeakMap,r.default.use||(e=>{switch(e.status){case"pending":throw e;case"fulfilled":return e.value;case"rejected":throw e.reason;default:throw e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e}})),Q={dedupe:!0},X=Promise.resolve(l),ee=()=>i;o.defineProperty(z,"defaultValue",{value:F});let et=(t=(e,t,n)=>{let{cache:i,compare:o,suspense:f,fallbackData:h,revalidateOnMount:x,revalidateIfStale:p,refreshInterval:g,refreshWhenHidden:b,refreshWhenOffline:w,keepPreviousData:y,strictServerPrefetchWarning:N}=n,[j,T,R,_]=s.get(i),[A,C]=L(e),V=(0,r.useRef)(!1),D=(0,r.useRef)(!1),$=(0,r.useRef)(A),I=(0,r.useRef)(t),U=(0,r.useRef)(n),W=()=>U.current.isVisible()&&U.current.isOnline(),[F,q,B,z]=v(i,A),H=(0,r.useRef)({}).current,Y=c(h)?c(n.fallback)?l:n.fallback[A]:h,K=(e,t)=>{for(let r in H)if("data"===r){if(!o(e[r],t[r])&&(!c(e[r])||!o(eo,t[r])))return!1}else if(t[r]!==e[r])return!1;return!0},Z=!V.current,et=(0,r.useMemo)(()=>{let e=F(),r=z(),a=e=>{let r=u(e);return(delete r._k,(()=>{if(!A||!t||U.current.isPaused())return!1;if(Z&&!c(x))return x;let e=c(Y)?r.data:Y;return c(e)||p})())?{isValidating:!0,isLoading:!0,...r}:r},n=a(e),s=e===r?n:a(r),i=n;return[()=>{let e=a(F());return K(e,i)?(i.data=e.data,i.isLoading=e.isLoading,i.isValidating=e.isValidating,i.error=e.error,i):(i=e,e)},()=>s]},[i,A]),er=(0,a.useSyncExternalStore)((0,r.useCallback)(e=>B(A,(t,r)=>{K(r,t)||e()}),[i,A]),et[0],et[1]),ea=j[A]&&j[A].length>0,en=er.data,es=c(en)?Y&&m(Y)?G(Y):Y:en,ei=er.error,el=(0,r.useRef)(es),eo=y?c(en)?c(el.current)?es:el.current:en:es,ec=A&&c(es),ed=(0,r.useRef)(null);S||(0,a.useSyncExternalStore)(ee,()=>(ed.current=!1,ed),()=>(ed.current=!0,ed));let eu=ed.current;N&&eu&&!f&&ec&&console.warn(`Missing pre-initiated data for serialized key "${A}" during server-side rendering. Data fetching should be initiated on the server and provided to SWR via fallback data. You can set "strictServerPrefetchWarning: false" to disable this warning.`);let em=!(!A||!t||U.current.isPaused())&&(!ea||!!c(ei))&&(Z&&!c(x)?x:f?!c(es)&&p:c(es)||p),ef=c(er.isValidating)?em:er.isValidating,eh=c(er.isLoading)?em:er.isLoading,ex=(0,r.useCallback)(async e=>{let t,r,a=I.current;if(!A||!a||D.current||U.current.isPaused())return!1;let s=!0,i=e||{},u=!R[A]||!i.dedupe,m=()=>E?!D.current&&A===$.current&&V.current:A===$.current,f={isValidating:!1,isLoading:!1},h=()=>{q(f)},x=()=>{let e=R[A];e&&e[1]===r&&delete R[A]},p={isValidating:!0};c(F().data)&&(p.isLoading=!0);try{if(u&&(q(p),n.loadingTimeout&&c(F().data)&&setTimeout(()=>{s&&m()&&U.current.onLoadingSlow(A,n)},n.loadingTimeout),R[A]=[a(C),M()]),[t,r]=R[A],t=await t,u&&setTimeout(x,n.dedupingInterval),!R[A]||R[A][1]!==r)return u&&m()&&U.current.onDiscarded(A),!1;f.error=l;let e=T[A];if(!c(e)&&(r<=e[0]||r<=e[1]||0===e[1]))return h(),u&&m()&&U.current.onDiscarded(A),!1;let i=F().data;f.data=o(i,t)?i:t,u&&m()&&U.current.onSuccess(t,A,n)}catch(r){x();let e=U.current,{shouldRetryOnError:t}=e;!e.isPaused()&&(f.error=r,u&&m()&&(e.onError(r,A,e),(!0===t||d(t)&&t(r))&&(!U.current.revalidateOnFocus||!U.current.revalidateOnReconnect||W())&&e.onErrorRetry(r,A,e,e=>{let t=j[A];t&&t[0]&&t[0](J.ERROR_REVALIDATE_EVENT,e)},{retryCount:(i.retryCount||0)+1,dedupe:!0})))}return s=!1,h(),!0},[A,i]),ep=(0,r.useCallback)((...e)=>P(i,$.current,...e),[]);if(k(()=>{I.current=t,U.current=n,c(en)||(el.current=en)}),k(()=>{var e;let t;if(!A)return;let r=ex.bind(l,Q),a=0;U.current.revalidateOnFocus&&(a=Date.now()+U.current.focusThrottleInterval);let n=(e=(e,t={})=>{if(e==J.FOCUS_EVENT){let e=Date.now();U.current.revalidateOnFocus&&e>a&&W()&&(a=e+U.current.focusThrottleInterval,r())}else if(e==J.RECONNECT_EVENT)U.current.revalidateOnReconnect&&W()&&r();else if(e==J.MUTATE_EVENT)return ex();else if(e==J.ERROR_REVALIDATE_EVENT)return ex(t)},(t=j[A]||(j[A]=[])).push(e),()=>{let r=t.indexOf(e);r>=0&&(t[r]=t[t.length-1],t.pop())});return D.current=!1,$.current=A,V.current=!0,q({_k:C}),em&&!R[A]&&(c(es)||S?r():O(r)),()=>{D.current=!0,n()}},[A]),k(()=>{let e;function t(){let t=d(g)?g(F().data):g;t&&-1!==e&&(e=setTimeout(r,t))}function r(){!F().error&&(b||U.current.isVisible())&&(w||U.current.isOnline())?ex(Q).then(t):t()}return t(),()=>{e&&(clearTimeout(e),e=-1)}},[g,b,w,A]),(0,r.useDebugValue)(eo),f){if(!E&&S&&ec)throw Error("Fallback data is required when using Suspense in SSR.");ec&&(I.current=t,U.current=n,D.current=!1);let e=_[A];if(G(!c(e)&&ec?ep(e):X),!c(ei)&&ec)throw ei;let r=ec?ex(Q):X;!c(eo)&&ec&&(r.status="fulfilled",r.value=!0),G(r)}return{mutate:ep,get data(){return H.data=!0,eo},get error(){return H.error=!0,ei},get isValidating(){return H.isValidating=!0,ef},get isLoading(){return H.isLoading=!0,eh}}},function(...e){let a,n=(a=(0,r.useContext)(B),(0,r.useMemo)(()=>u(F,a),[a])),[s,i,l]=d(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(null===e[1]?e[2]:e[1])||{}],o=q(n,l),c=t,{use:m}=o,f=(m||[]).concat(Y);for(let e=f.length;e--;)c=f[e](c);return c(s,i||o.fetcher||null,o)});e.s(["default",()=>et],83599)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},16715,e=>{"use strict";let t=(0,e.i(75254).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},14764,e=>{"use strict";let t=(0,e.i(75254).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],14764)},75558,25063,e=>{"use strict";var t=e.i(75254);let r=(0,t.default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);e.s(["ArrowUp",()=>r],75558);let a=(0,t.default)("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);e.s(["ArrowDown",()=>a],25063)},39584,e=>{"use strict";var t=e.i(43476),r=e.i(83599),a=e.i(17805),a=a,n=e.i(9165),s=e.i(32341),i=e.i(71645);let l=(0,e.i(75254).default)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);var o=e.i(75558),c=e.i(25063),d=e.i(16715),u=e.i(14764),m=e.i(7233);function f(){let{token:e}=(0,s.useAuth)(),[a,o]=(0,i.useState)("top"),{data:c,error:u,isLoading:f,mutate:x}=(0,r.default)("/api/posts",n.api),p=c?.posts??[],g=(0,i.useMemo)(()=>{let e;return e=[...p],"top"===a?e.sort((e,t)=>{let r=(t.votes??0)-(e.votes??0);if(0!==r)return r;let a=e.createdAt?new Date(e.createdAt).getTime():0;return(t.createdAt?new Date(t.createdAt).getTime():0)-a}):e.sort((e,t)=>{let r=e.createdAt?new Date(e.createdAt).getTime():0;return(t.createdAt?new Date(t.createdAt).getTime():0)-r})},[p,a]);async function b(t,r){if(!e)return alert("Please login to vote.");let a=(c?.posts??[]).find(e=>e._id===t),s=a?.myVote??0;if(s===r)return void alert("You already voted this way.");let i=s,l=0;1===r?-1===s?(i=0,l=1):0===s&&(i=1,l=1):1===s?(i=0,l=-1):0===s&&(i=-1,l=-1),0!==l&&await x(async e=>{if(!e)return e;let a={...e,posts:e.posts.map(e=>e._id!==t?e:{...e,myVote:i,votes:(e.votes??0)+l})};try{await (0,n.api)(`/api/posts/${t}/vote`,{method:"POST",body:JSON.stringify({delta:r})})}catch(t){return e}return a},{revalidate:!0,rollbackOnError:!0})}return(0,t.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-100",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-blue-900 to-indigo-600 text-white",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-22 pb-10",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-4xl md:text-5xl font-bold mb-2",children:"Community"}),(0,t.jsx)("p",{className:"text-xl text-blue-100 max-w-3xl mx-auto",children:"Connect with fellow auto enthusiasts and find the perfect parts for your vehicle."})]})})}),(0,t.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-10 md:py-16",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow",children:(0,t.jsx)(l,{className:"w-6 h-6 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"Community"}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:e?"Logged in - you can vote and comment":"Not logged in - login to vote and comment"})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsxs)("div",{className:"inline-flex items-center rounded-xl border border-slate-200 bg-white p-1",children:[(0,t.jsx)("button",{onClick:()=>o("top"),className:`px-3 py-1.5 rounded-lg text-sm transition ${"top"===a?"bg-slate-900 text-white":"text-slate-700 hover:bg-slate-50"}`,children:"Top"}),(0,t.jsx)("button",{onClick:()=>o("new"),className:`px-3 py-1.5 rounded-lg text-sm transition ${"new"===a?"bg-slate-900 text-white":"text-slate-700 hover:bg-slate-50"}`,children:"New"})]}),(0,t.jsxs)("button",{onClick:()=>x(),className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-4 py-2 hover:bg-slate-50 transition",children:[(0,t.jsx)(d.RefreshCw,{className:"w-4 h-4"}),"Refresh"]}),(0,t.jsxs)("a",{href:e?"/community/new":"/login",className:"inline-flex items-center gap-2 rounded-xl bg-slate-900 text-white px-4 py-2 hover:opacity-90 transition",children:[(0,t.jsx)(m.Plus,{className:"w-4 h-4"}),"New Post"]})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:f?Array.from({length:3}).map((e,r)=>(0,t.jsx)("div",{className:"h-32 rounded-2xl border border-slate-200 bg-white animate-pulse"},r)):u?(0,t.jsx)("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 p-4 text-rose-700",children:"Error loading posts. Please try again."}):0===g.length?(0,t.jsx)("div",{className:"rounded-2xl border border-slate-200 bg-white p-8 text-center",children:(0,t.jsx)("p",{className:"text-slate-700",children:"No posts yet."})}):g.map(e=>(0,t.jsx)(h,{post:e,onVote:t=>b(e._id,t)},e._id))})]})]})}function h({post:e,onVote:r}){let{token:a}=(0,s.useAuth)(),[n,d]=(0,i.useState)(!1);return(0,t.jsx)("article",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>r(1),className:`h-9 w-9 inline-flex items-center justify-center rounded-lg border transition
              ${1===e.myVote?"border-blue-500 text-blue-600 bg-blue-50":"border-slate-200 text-slate-500 hover:bg-slate-50"}
            `,"aria-label":"Upvote",children:(0,t.jsx)(o.ArrowUp,{className:"w-4 h-4"})}),(0,t.jsx)("div",{className:"text-sm font-semibold text-slate-700",children:e.votes??0}),(0,t.jsx)("button",{onClick:()=>r(-1),className:`h-9 w-9 inline-flex items-center justify-center rounded-lg border transition
              ${-1===e.myVote?"border-rose-500 text-rose-600 bg-rose-50":"border-slate-200 text-slate-500 hover:bg-slate-50"}
            `,"aria-label":"Downvote",children:(0,t.jsx)(c.ArrowDown,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:e.title}),e.body&&(0,t.jsx)("p",{className:"mt-1 text-slate-700",children:e.body}),(0,t.jsxs)("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.authorName&&(0,t.jsxs)("span",{className:"text-xs text-slate-500",children:["By ",e.authorName]}),e.createdAt&&(0,t.jsxs)("span",{className:"text-xs text-slate-500",children:["• ",new Date(e.createdAt).toLocaleString()]}),(0,t.jsx)("span",{className:"text-xs text-slate-400",children:"•"}),(0,t.jsxs)("span",{className:"text-sm text-slate-600",children:[e.commentsCount??0," comments"]})]}),(0,t.jsxs)("div",{className:"mt-4 flex items-center gap-3",children:[(0,t.jsxs)("button",{onClick:()=>d(e=>!e),className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-50 transition",children:[(0,t.jsx)(l,{className:"w-4 h-4"}),n?"Hide":"Show"," comments"]}),(0,t.jsx)("a",{href:`/community/${e._id}`,className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-50 transition",children:"View post"})]}),n&&(0,t.jsx)(x,{postId:e._id})]})]})})}function x({postId:e}){let{token:l}=(0,s.useAuth)(),o=`/api/posts/${e}/comments`,{data:c,error:d,isLoading:m,mutate:f}=(0,r.default)(o,n.api),h=c?.comments??[],[x,p]=(0,i.useState)("");async function g(){if(!l)return alert("Please login to comment.");let t=x.trim();if(!t)return;let r={_id:"tmp_"+Math.random().toString(36).slice(2),authorName:"You",text:t,createdAt:new Date().toISOString()};await f(async a=>{let s={comments:[r,...a?.comments??[]]};return await (0,n.api)(`/api/posts/${e}/comments`,{method:"POST",body:JSON.stringify({text:t})}),s},{revalidate:!0,rollbackOnError:!0}),p(""),(0,a.j)("/api/posts")}return(0,t.jsxs)("div",{className:"mt-4 rounded-xl border border-slate-200 bg-slate-50 p-4",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{value:x,onChange:e=>p(e.target.value),placeholder:l?"Write a comment…":"Login to comment",className:"flex-1 rounded-lg border border-slate-200 bg-white px-3 py-2 text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!l}),(0,t.jsxs)("button",{onClick:g,disabled:!l||0===x.trim().length,className:"inline-flex items-center gap-2 rounded-lg bg-slate-900 text-white px-3 py-2 hover:opacity-90 transition disabled:opacity-50",children:[(0,t.jsx)(u.Send,{className:"w-4 h-4"}),"Send"]})]}),(0,t.jsx)("div",{className:"mt-4 space-y-3",children:m?Array.from({length:2}).map((e,r)=>(0,t.jsx)("div",{className:"h-12 rounded-lg border border-slate-200 bg-white animate-pulse"},r)):d?(0,t.jsx)("div",{className:"rounded-lg border border-rose-200 bg-rose-50 p-3 text-rose-700 text-sm",children:"Failed to load comments."}):0===h.length?(0,t.jsx)("div",{className:"text-sm text-slate-600",children:"No comments yet. Be the first!"}):h.map(e=>(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white p-3",children:[(0,t.jsxs)("div",{className:"text-xs text-slate-500",children:[(0,t.jsx)("span",{className:"font-medium text-slate-700",children:e.authorName})," •"," ",new Date(e.createdAt).toLocaleString()]}),(0,t.jsx)("p",{className:"mt-1 text-slate-800",children:e.text})]},e._id))})]})}e.s(["default",()=>f],39584)}]);